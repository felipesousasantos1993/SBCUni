<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="/template/template.xhtml"
>
	<ui:define name="conteudo">
	<div class="page-header">
		<ol class="breadcrumb breadcrumb-page">
			<li>
				<h:outputLink>
					<h:outputText value="#{mensagens['display.voce.esta.em']}" />
				</h:outputLink>
			</li>
			<li>
				<h:outputText value="#{mensagens['display.menu.topico']}" />
			</li>
			<li class="active">
				<h:outputText value="#{mensagens['display.ultimos.topicos']}" />
			</li>
		</ol>
		<h:messages id="mensagens"  errorClass="alert alert-danger alert-dark" infoClass="alert alert-info alert-dark" warnClass="alert alert-dark"/>
	</div>
	<div id="content" class="content">
		<h:form prependId="false" id="form">
		<h:inputHidden id="validator"/>
			<div class="row">
				<div class="col-md-12">
					<ul class="linhaDoTempo">
						<ui:repeat var="topico" varStatus="topicoStatus" value="#{ultimosTopicosBean.topicos}">
							<li class="linhaDoTempo-inverted">
								
								<h:outputFormat rendered="#{topicoStatus.index eq 0}" >
									<div class="linhaDoTempo-badge info">
										<i class="glyphicon glyphicon-home"/>
									</div>
								</h:outputFormat>
								<h:outputFormat rendered="#{topicoStatus.index gt 0}" >
									<div class="linhaDoTempo-badge success">
										<i class="glyphicon glyphicon-comment"/>
									</div>
								</h:outputFormat>
								
								 <div id="panel" class="linhaDoTempo-panel">
								 <h:panelGroup id="avaliacao">
								 	<div class="linhaDoTempo-heading">
								 		  <h4 class="linhaDoTempo-title"><h:commandLink immediate="true" action="#{ultimosTopicosBean.detalharTopico(topico)}" value="#{topico.titulo}"/> </h4>
								 		  <div class="box-tools pull-right" align="right">
									 			<h:panelGroup rendered="#{topico.avaliacaoUsuario.avaliacao == false}"> 
									 		 		<h:commandLink >
									 		 			<h:outputText value="#{topico.nuAvaliacaoPositivas}" />
									 		 			<i class="glyphicon glyphicon-thumbs-up" />
									 		 			<f:ajax event="click" render="avaliacao" listener="#{ultimosTopicosBean.curtirTopico(topico)}" immediate="true" execute="@form"/>
									 		 		</h:commandLink>
									 		 		<h:commandLink styleClass="disabled-editado marginLeft_10">
									 		 			<i class="glyphicon glyphicon-thumbs-down" />
									 		 			<f:ajax event="click" render="avaliacao" listener="#{ultimosTopicosBean.removerAvaliacaoTopico(topico)}" immediate="true" execute="@form"/>
									 		 		</h:commandLink>
										 			<h:outputText value="#{topico.nuAvaliacaoNegativas}" styleClass="marginLeft_10"/>
									 		 	</h:panelGroup>
									 		 	<h:panelGroup rendered="#{topico.avaliacaoUsuario.avaliacao == true}">
									 		 		<h:commandLink styleClass="disabled-editado">
											 			<h:outputText value="#{topico.nuAvaliacaoPositivas}" />
										 		 		<i class="glyphicon glyphicon-thumbs-up" />
										 		 		<f:ajax event="click" render="avaliacao" listener="#{ultimosTopicosBean.removerAvaliacaoTopico(topico)}" immediate="true" execute="@form"/>
									 		 		</h:commandLink>
										 		 	<h:commandLink styleClass="marginLeft_10">
										 		 		<i class="glyphicon glyphicon-thumbs-down" />
										 		 		<f:ajax event="click" execute="avaliacao" render="avaliacao" listener="#{ultimosTopicosBean.descurtirTopico(topico)}"/>
									 		 		</h:commandLink>
										 			<h:outputText value="#{topico.nuAvaliacaoNegativas}" styleClass="marginLeft_10"/>
									 		 	</h:panelGroup>
									 		 	<h:panelGroup rendered="#{empty topico.avaliacaoUsuario}">
									 		 		<h:commandLink  >
											 			<h:outputText value="#{topico.nuAvaliacaoPositivas}" />
									 		 			<i class="glyphicon glyphicon-thumbs-up" />
									 		 			<f:ajax event="click" render="avaliacao" listener="#{ultimosTopicosBean.curtirTopico(topico)}" immediate="true" execute="@form"/>
									 		 		</h:commandLink>
									 		 		<h:commandLink styleClass="marginLeft_10">
										 		 		<i class="glyphicon glyphicon-thumbs-down" />
										 		 		<f:ajax event="click" execute="avaliacao" render="avaliacao" listener="#{ultimosTopicosBean.descurtirTopico(topico)}"/>
									 		 		</h:commandLink>
										 			<h:outputText value="#{topico.nuAvaliacaoNegativas}" styleClass="marginLeft_10"/>
									 		 	</h:panelGroup>
								 		 	</div>
								 		  <p>
									 		  <small class="text-muted"><i class="glyphicon glyphicon-time" style="margin-right: 2px;"/> 
								 		  	  <h:outputText value="#{topico.dtCriacao}" >
													<f:convertDateTime locale="pt_BR" timeZone="America/Sao_Paulo" pattern="EEE, dd/MM/yyyy - hh:mm"/>
												</h:outputText>
												<label><h:outputText value="#{mensagens['display.atualizado.em']}: "  rendered="#{not empty topico.dtUltimaAtualizacao}"/> </label>
											   	<h:outputText value="#{topico.dtUltimaAtualizacao}" rendered="#{not empty topico.dtUltimaAtualizacao}" >
													<f:convertDateTime locale="pt_BR" timeZone="America/Sao_Paulo" pattern="EEE, dd/MM/yyyy - hh:mm"/>
												</h:outputText>
									 		  </small>
								 		  </p>
								 		  	<small>
								 		  	<label>
								 		  		<h:outputText style="margin-right: 2px;" value="#{mensagens['display.autor']}: " />
								 		  	</label>
								 		  	<h:outputText value="#{topico.usuario.nome}" />
								 		  	</small>
								 	</div>
								 		<div class="linhaDoTempo-footer">
							                <h:commandLink action="#{ultimosTopicosBean.detalharTopico(topico)}"  value="#{mensagens['display.visualizar']}" styleClass="btn btn-default btn-outline btn-xs">
							                	<i class="glyphicon glyphicon-zoom-in"/>
							                </h:commandLink>
						                 	<h:commandLink action="#{ultimosTopicosBean.telaAtualizarTopico(topico)}" rendered="#{topico.usuario.idUsuario eq usuarioSessionBean.usuarioSessao.idUsuario}" value="#{mensagens['display.alterar']}" styleClass="btn btn-default btn-outline btn-xs marginLeft_10" >
						                 		<span class="fa fa-edit"/>
						                 	</h:commandLink>
					                  		<h:commandLink title="Excluir" value="#{mensagens['display.excluir']}" rendered="#{topico.usuario.idUsuario eq usuarioSessionBean.usuarioSessao.idUsuario}" styleClass="btn btn-danger btn-outline btn-xs marginLeft_10">
					                  			<i class="glyphicon glyphicon-trash"/>
												<f:ajax event="click" execute="@this" onevent="showModalDelete('modalExcluir')"  listener="#{ultimosTopicosBean.topicoExcluir(topico)}" />	
											</h:commandLink>
										<div class="box-tools pull-right" align="right">
											<ui:repeat var="categoria" value="#{topico.categorias}">
												<h:outputText styleClass="label label-tag marginLeft_5" value="#{categoria.deCategoria}" />
											</ui:repeat>
										</div>
								 	</div>
								 	</h:panelGroup>
							 	</div>
							</li>
						
						</ui:repeat>
					
					</ul>
					
				
				</div>
			</div>
			
			<div class="clear"/>
			
			</h:form>
			
		</div>
		<ui:include src="/paginas/util/modalGenerico.xhtml" >
		    <ui:param name="bean" value="#{ultimosTopicosBean}" />
		    <ui:param name="nomeModal" value="modalExcluir" />
		    <ui:param name="titulo" value="#{mensagens['display.confirma.exclusao.topico']}" />
		    <ui:param name="mensagem" value="" />
		</ui:include>
	</ui:define>
</ui:composition>